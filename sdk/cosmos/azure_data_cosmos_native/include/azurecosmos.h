// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.

// This file is auto-generated by cbindgen. Do not edit manually.
// cSpell: disable


#include <stdarg.h>
#include <stdbool.h>
#include <stdint.h>
#include <stdlib.h>

// Specifies the version of cosmosclient this header file was generated from.
// This should match the version of libcosmosclient you are referencing.
#define COSMOSCLIENT_H_VERSION "0.27.0"

enum cosmos_error_code
#ifdef __cplusplus
  : int32_t
#endif // __cplusplus
 {
  COSMOS_ERROR_CODE_SUCCESS = 0,
  COSMOS_ERROR_CODE_INVALID_ARGUMENT = 1,
  COSMOS_ERROR_CODE_CONNECTION_FAILED = 2,
  COSMOS_ERROR_CODE_UNKNOWN_ERROR = 999,
  COSMOS_ERROR_CODE_BAD_REQUEST = 400,
  COSMOS_ERROR_CODE_UNAUTHORIZED = 401,
  COSMOS_ERROR_CODE_FORBIDDEN = 403,
  COSMOS_ERROR_CODE_NOT_FOUND = 404,
  COSMOS_ERROR_CODE_CONFLICT = 409,
  COSMOS_ERROR_CODE_PRECONDITION_FAILED = 412,
  COSMOS_ERROR_CODE_REQUEST_TIMEOUT = 408,
  COSMOS_ERROR_CODE_TOO_MANY_REQUESTS = 429,
  COSMOS_ERROR_CODE_INTERNAL_SERVER_ERROR = 500,
  COSMOS_ERROR_CODE_BAD_GATEWAY = 502,
  COSMOS_ERROR_CODE_SERVICE_UNAVAILABLE = 503,
  COSMOS_ERROR_CODE_AUTHENTICATION_FAILED = 1001,
  COSMOS_ERROR_CODE_DATA_CONVERSION = 1002,
  COSMOS_ERROR_CODE_PARTITION_KEY_MISMATCH = 2001,
  COSMOS_ERROR_CODE_RESOURCE_QUOTA_EXCEEDED = 2002,
  COSMOS_ERROR_CODE_REQUEST_RATE_TOO_LARGE = 2003,
  COSMOS_ERROR_CODE_ITEM_SIZE_TOO_LARGE = 2004,
  COSMOS_ERROR_CODE_PARTITION_KEY_NOT_FOUND = 2005,
  COSMOS_ERROR_CODE_INTERNAL_ERROR = 3001,
  COSMOS_ERROR_CODE_INVALID_UTF8 = 3002,
  COSMOS_ERROR_CODE_INVALID_HANDLE = 3003,
  COSMOS_ERROR_CODE_MEMORY_ERROR = 3004,
  COSMOS_ERROR_CODE_MARSHALING_ERROR = 3005,
  COSMOS_ERROR_CODE_CALL_CONTEXT_MISSING = 3006,
  COSMOS_ERROR_CODE_RUNTIME_CONTEXT_MISSING = 3007,
  COSMOS_ERROR_CODE_INVALID_C_STRING = 3008,
};
#ifndef __cplusplus
typedef int32_t cosmos_error_code;
#endif // __cplusplus

/**
 * A client for working with a specific container in a Cosmos DB account.
 *
 * You can get a `Container` by calling [`DatabaseClient::container_client()`](crate::clients::DatabaseClient::container_client()).
 */
typedef struct cosmos_container_client cosmos_container_client;

/**
 * Client for Azure Cosmos DB.
 */
typedef struct cosmos_client cosmos_client;

/**
 * A client for working with a specific database in a Cosmos DB account.
 *
 * You can get a `DatabaseClient` by calling [`CosmosClient::database_client()`](crate::CosmosClient::database_client()).
 */
typedef struct cosmos_database_client cosmos_database_client;

typedef struct cosmos_InnerPartitionKeyValue cosmos_InnerPartitionKeyValue;

/**
 * Provides a RuntimeContext (see [`crate::runtime`]) implementation using the Tokio runtime.
 */
typedef struct cosmos_runtime_context cosmos_runtime_context;

/**
 * External representation of an error across the FFI boundary.
 */
typedef struct cosmos_error {
  /**
   * The error code representing the type of error.
   */
  cosmos_error_code code;
  /**
   * A static C string message describing the error. This value does not need to be freed.
   */
  const char *message;
  /**
   * An optional detailed C string message providing additional context about the error.
   * This is only set if [`include_error_details`](crate::context::CallContext::include_error_details) is true.
   * If this pointer is non-null, it must be freed by the caller using [`cosmos_string_free`](crate::string::cosmos_string_free).
   */
  const char *detail;
} cosmos_error;

/**
 * Represents the context for a call into the Cosmos DB native SDK.
 *
 * This structure can be created on the caller side, as long as the caller is able to create a C-compatible struct.
 * The `runtime_context` field must be set to a pointer to a `RuntimeContext` created by the
 * [`cosmos_runtime_context_create`](crate::runtime::cosmos_runtime_context_create) function.
 *
 * The structure can also be created using [`cosmos_call_context_create`],
 * in which case Rust will manage the memory for the structure, and it must be freed using [`cosmos_call_context_free`].
 *
 * This structure must remain active and at the memory address specified in the function call for the duration of the call into the SDK.
 * If calling an async function, that may mean it must be allocated on the heap to ensure it remains live (depending on the caller's language/runtime).
 *
 * A single [`CallContext`] may be reused for multiple calls, but cannot be used concurrently from multiple threads.
 * When reusing a [`CallContext`] the [`CallContext::error`] field will be overwritten with the error from the most recent call.
 * Error details will NOT be freed if the context is reused; the caller is responsible for freeing any error details if needed.
 */
typedef struct cosmos_call_context {
  /**
   * Pointer to a RuntimeContext created by [`cosmos_runtime_context_create`](crate::runtime::cosmos_runtime_context_create).
   */
  const struct cosmos_runtime_context *runtime_context;
  /**
   * Indicates whether detailed case-specific error information should be included in error responses.
   *
   * Normally, a [`CosmosError`] contains only a static error message, which does not need to be freed.
   * However, this also means that the error message may not contain detailed information about the specific error that occurred.
   * If this field is set to true, the SDK will allocate a detailed error message string for each error that occurs,
   * which must be freed by the caller using [`cosmos_string_free`](crate::string::cosmos_string_free) after each error is handled.
   */
  bool include_error_details;
  /**
   * Holds the error information for the last operation performed using this context.
   *
   * The value of this is ignored on input; it is only set by the SDK to report errors.
   * The [`CosmosError::code`] field will always match the returned error code from the function.
   * The string associated with the error (if any) will be allocated by the SDK and must be freed
   * by the caller using the appropriate function.
   */
  struct cosmos_error error;
} cosmos_call_context;

typedef struct cosmos_call_context_options {
  bool include_error_details;
} cosmos_call_context_options;

typedef struct cosmos_item_options {
  /**
   * Placeholder field used to avoid an empty struct (which is not valid in standard C). This field may be removed at any time.
   */
  uint8_t _unused;
} cosmos_item_options;

typedef struct cosmos_read_container_options {
  /**
   * Placeholder field used to avoid an empty struct (which is not valid in standard C). This field may be removed at any time.
   */
  uint8_t _unused;
} cosmos_read_container_options;

typedef struct cosmos_delete_container_options {
  /**
   * Placeholder field used to avoid an empty struct (which is not valid in standard C). This field may be removed at any time.
   */
  uint8_t _unused;
} cosmos_delete_container_options;

typedef struct cosmos_query_options {
  /**
   * Placeholder field used to avoid an empty struct (which is not valid in standard C). This field may be removed at any time.
   */
  uint8_t _unused;
} cosmos_query_options;

typedef struct cosmos_client_options {
  /**
   * If true, disables certificate validation. Use only for testing.
   */
  bool danger_allow_invalid_certificates;
} cosmos_client_options;

typedef struct cosmos_create_database_options {
  /**
   * Placeholder field used to avoid an empty struct (which is not valid in standard C). This field may be removed at any time.
   */
  uint8_t _unused;
} cosmos_create_database_options;

typedef struct cosmos_read_database_options {
  /**
   * Placeholder field used to avoid an empty struct (which is not valid in standard C). This field may be removed at any time.
   */
  uint8_t _unused;
} cosmos_read_database_options;

typedef struct cosmos_delete_database_options {
  /**
   * Placeholder field used to avoid an empty struct (which is not valid in standard C). This field may be removed at any time.
   */
  uint8_t _unused;
} cosmos_delete_database_options;

typedef struct cosmos_create_container_options {
  /**
   * Placeholder field used to avoid an empty struct (which is not valid in standard C). This field may be removed at any time.
   */
  uint8_t _unused;
} cosmos_create_container_options;

typedef struct cosmos_runtime_options {
  /**
   * Placeholder field used to avoid an empty struct (which is not valid in standard C). This field may be removed at any time.
   */
  uint8_t _unused;
} cosmos_runtime_options;







#ifdef __cplusplus
extern "C" {
#endif // __cplusplus

/**
 * Returns a constant C string containing the version of the Cosmos Client library.
 */
const char *cosmos_version(void);

/**
 * Installs tracing listeners that output to stdout/stderr based on the `COSMOS_LOG` environment variable.
 *
 * Just calling this function isn't sufficient to get logging output. You must also set the `COSMOS_LOG` environment variable
 * to specify the desired log level and targets. See <https://docs.rs/tracing-subscriber/latest/tracing_subscriber/filter/struct.EnvFilter.html>
 * for details on the syntax for this variable.
 */
void cosmos_enable_tracing(void);

/**
 * Releases the memory associated with a C string obtained from Rust.
 */
void cosmos_string_free(const char *str);

/**
 * Creates a new [`CallContext`] and returns a pointer to it.
 * This must be freed using [`cosmos_call_context_free`] when no longer needed.
 *
 * A [`CallContext`] may be reused for multiple calls, but cannot be used concurrently from multiple threads.
 *
 * # Arguments
 * * `runtime_context` - Pointer to a [`RuntimeContext`] created by [`cosmos_runtime_context_create`](crate::runtime::cosmos_runtime_context_create).
 * * `options` - Pointer to [`CallContextOptions`] for call configuration, may be null.
 */
struct cosmos_call_context *cosmos_call_context_create(const struct cosmos_runtime_context *runtime_context,
                                                       const struct cosmos_call_context_options *options);

/**
 * Frees a [`CallContext`] created by [`cosmos_call_context_create`].
 */
void cosmos_call_context_free(struct cosmos_call_context *ctx);

/**
 * Releases the memory associated with a [`ContainerClient`].
 */
void cosmos_container_free(struct cosmos_container_client *container);

/**
 * Creates a new item in the specified container.
 *
 * # Arguments
 * * `ctx` - Pointer to a [`CallContext`] to use for this call.
 * * `container` - Pointer to the `ContainerClient`.
 * * `partition_key` - The partition key value as a nul-terminated C string.
 * * `json_data` - The item data as a raw JSON nul-terminated C string.
 * * `options` - Pointer to [`ItemOptions`] for item creation configuration, may be null.
 */
cosmos_error_code cosmos_container_create_item(struct cosmos_call_context *ctx,
                                               const struct cosmos_container_client *container,
                                               const char *partition_key,
                                               const char *json_data,
                                               const struct cosmos_item_options *options);

/**
 * Upserts an item in the specified container.
 *
 * # Arguments
 * * `ctx` - Pointer to a [`CallContext`] to use for this call.
 * * `container` - Pointer to the `ContainerClient`.
 * * `partition_key` - The partition key value as a nul-terminated C string.
 * * `json_data` - The item data as a raw JSON nul-terminated C string.
 * * `options` - Pointer to [`ItemOptions`] for item upsert configuration, may be null.
 */
cosmos_error_code cosmos_container_upsert_item(struct cosmos_call_context *ctx,
                                               const struct cosmos_container_client *container,
                                               const char *partition_key,
                                               const char *json_data,
                                               const struct cosmos_item_options *options);

/**
 * Reads an item from the specified container.
 *
 * # Arguments
 * * `ctx` - Pointer to a [`CallContext`] to use for this call.
 * * `container` - Pointer to the `ContainerClient`.
 * * `partition_key` - The partition key value as a nul-terminated C string.
 * * `item_id` - The ID of the item to read as a nul-terminated C string.
 * * `options` - Pointer to [`ItemOptions`] for item read configuration, may be null.
 * * `out_json` - Output parameter that will receive the item data as a raw JSON nul-terminated C string.
 */
cosmos_error_code cosmos_container_read_item(struct cosmos_call_context *ctx,
                                             const struct cosmos_container_client *container,
                                             const char *partition_key,
                                             const char *item_id,
                                             const struct cosmos_item_options *options,
                                             const char **out_json);

/**
 * Replaces an existing item in the specified container.
 *
 * # Arguments
 * * `ctx` - Pointer to a [`CallContext`] to use for this call.
 * * `container` - Pointer to the `ContainerClient`.
 * * `partition_key` - The partition key value as a nul-terminated C string.
 * * `item_id` - The ID of the item to replace as a nul-terminated C string.
 * * `json_data` - The new item data as a raw JSON nul-terminated C string.
 * * `options` - Pointer to [`ItemOptions`] for item replacement configuration, may be null.
 */
cosmos_error_code cosmos_container_replace_item(struct cosmos_call_context *ctx,
                                                const struct cosmos_container_client *container,
                                                const char *partition_key,
                                                const char *item_id,
                                                const char *json_data,
                                                const struct cosmos_item_options *options);

/**
 * Deletes an item from the specified container.
 *
 * # Arguments
 * * `ctx` - Pointer to a [`CallContext`] to use for this call.
 * * `container` - Pointer to the `ContainerClient`.
 * * `partition_key` - The partition key value as a nul-terminated C string.
 * * `item_id` - The ID of the item to delete as a nul-terminated C string.
 * * `options` - Pointer to [`ItemOptions`] for item deletion configuration, may be null.
 */
cosmos_error_code cosmos_container_delete_item(struct cosmos_call_context *ctx,
                                               const struct cosmos_container_client *container,
                                               const char *partition_key,
                                               const char *item_id,
                                               const struct cosmos_item_options *options);

/**
 * Reads the properties of the specified container.
 *
 * # Arguments
 * * `ctx` - Pointer to a [`CallContext`] to use for this call.
 * * `container` - Pointer to the `ContainerClient`.
 * * `options` - Pointer to [`ReadContainerOptions`] for read container configuration, may be null.
 * * `out_json` - Output parameter that will receive the container properties as a raw JSON nul-terminated C string.
 */
cosmos_error_code cosmos_container_read(struct cosmos_call_context *ctx,
                                        const struct cosmos_container_client *container,
                                        const struct cosmos_read_container_options *options,
                                        const char **out_json);

/**
 * Deletes the specified container.
 *
 * # Arguments
 * * `ctx` - Pointer to a [`CallContext`] to use for this call.
 * * `container` - Pointer to the [`ContainerClient`].
 * * `options` - Pointer to [`DeleteContainerOptions`] for delete container configuration, may be null.
 */
cosmos_error_code cosmos_container_delete(struct cosmos_call_context *ctx,
                                          const struct cosmos_container_client *container,
                                          const struct cosmos_delete_container_options *options);

/**
 * Queries items in the specified container.
 *
 * # Arguments
 * * `ctx` - Pointer to a [`CallContext`] to use for this call.
 * * `container` - Pointer to the `ContainerClient`.
 * * `query` - The query to execute as a nul-terminated C string.
 * * `partition_key` - Optional partition key value as a nul-terminated C string. Specify a null pointer for a cross-partition query.
 * * `options` - Pointer to [`QueryOptions`] for query configuration, may be null.
 * * `out_json` - Output parameter that will receive the query results as a raw JSON nul-terminated C string.
 */
cosmos_error_code cosmos_container_query_items(struct cosmos_call_context *ctx,
                                               const struct cosmos_container_client *container,
                                               const char *query,
                                               const char *partition_key,
                                               const struct cosmos_query_options *options,
                                               const char **out_json);

/**
 * Creates a new CosmosClient and returns a pointer to it via the out parameter.
 *
 * # Arguments
 * * `ctx` - Pointer to a [`CallContext`] to use for this call.
 * * `endpoint` - The Cosmos DB account endpoint, as a nul-terminated C string.
 * * `key` - The Cosmos DB account key, as a nul-terminated C string
 * * `options` - Pointer to [`ClientOptions`] for client configuration, may be null.
 * * `out_client` - Output parameter that will receive a pointer to the created CosmosClient.
 *
 * # Returns
 * * Returns [`CosmosErrorCode::Success`] on success.
 * * Returns [`CosmosErrorCode::InvalidArgument`] if any input pointer is null or if the input strings are invalid.
 */
cosmos_error_code cosmos_client_create_with_key(struct cosmos_call_context *ctx,
                                                const char *endpoint,
                                                const char *key,
                                                const struct cosmos_client_options *options,
                                                struct cosmos_client **out_client);

/**
 * Creates a new CosmosClient using a connection string and returns a pointer to it via the out parameter.
 *
 * # Arguments
 * * `ctx` - Pointer to a [`CallContext`] to use for this call.
 * * `connection_string` - The Cosmos DB connection string, as a nul-terminated C string.
 *                         Can be "emulator" to use the well-known emulator endpoint and key,
 *                         or a full connection string in the format:
 *                         `AccountEndpoint=https://...;AccountKey=...;`
 * * `options` - Pointer to [`ClientOptions`] for client configuration, may be null.
 * * `out_client` - Output parameter that will receive a pointer to the created CosmosClient.
 *
 * # Returns
 * * Returns [`CosmosErrorCode::Success`] on success.
 * * Returns [`CosmosErrorCode::InvalidArgument`] if any input pointer is null or if the input string is invalid.
 */
cosmos_error_code cosmos_client_create_with_connection_string(struct cosmos_call_context *ctx,
                                                              const char *connection_string,
                                                              const struct cosmos_client_options *options,
                                                              struct cosmos_client **out_client);

/**
 * Releases the memory associated with a [`CosmosClient`].
 */
void cosmos_client_free(struct cosmos_client *client);

/**
 * Gets a [`DatabaseClient`] from the given [`CosmosClient`] for the specified database ID.
 *
 * # Arguments
 * * `ctx` - Pointer to a [`CallContext`] to use for this call.
 * * `client` - Pointer to the [`CosmosClient`].
 * * `database_id` - The database ID as a nul-terminated C string.
 * * `out_database` - Output parameter that will receive a pointer to the created [`DatabaseClient`].
 */
cosmos_error_code cosmos_client_database_client(struct cosmos_call_context *ctx,
                                                const struct cosmos_client *client,
                                                const char *database_id,
                                                struct cosmos_database_client **out_database);

/**
 * Queries the databases in the Cosmos DB account using the provided SQL query string.
 *
 * # Arguments
 * * `ctx` - Pointer to a [`CallContext`] to use for this call.
 * * `client` - Pointer to the [`CosmosClient`].
 * * `query` - The SQL query string as a nul-terminated C string.
 * * `options` - Pointer to [`QueryOptions`] for query configuration, may be null.
 * * `out_json` - Output parameter that will receive a pointer to the resulting JSON string
 */
cosmos_error_code cosmos_client_query_databases(struct cosmos_call_context *ctx,
                                                const struct cosmos_client *client,
                                                const char *query,
                                                const struct cosmos_query_options *options,
                                                const char **out_json);

/**
 * Creates a new database in the Cosmos DB account with the specified database ID, and returns a pointer to the created [`DatabaseClient`].
 *
 * # Arguments
 * * `ctx` - Pointer to a [`CallContext`] to use for this call.
 * * `client` - Pointer to the [`CosmosClient`].
 * * `options` - Pointer to [`CreateDatabaseOptions`] for create database configuration, may be null.
 * * `database_id` - The database ID as a nul-terminated C string.
 */
cosmos_error_code cosmos_client_create_database(struct cosmos_call_context *ctx,
                                                const struct cosmos_client *client,
                                                const char *database_id,
                                                const struct cosmos_create_database_options *options,
                                                struct cosmos_database_client **out_database);

/**
 * Releases the memory associated with a [`DatabaseClient`].
 */
void cosmos_database_free(struct cosmos_database_client *database);

/**
 * Retrieves a pointer to a [`ContainerClient`] for the specified container ID within the given database.
 *
 * # Arguments
 * * `ctx` - Pointer to a [`CallContext`] to use for this call.
 * * `database` - Pointer to the [`DatabaseClient`].
 * * `container_id` - The container ID as a nul-terminated C string.
 * * `out_container` - Output parameter that will receive a pointer to the [`ContainerClient`].
 */
cosmos_error_code cosmos_database_container_client(struct cosmos_call_context *ctx,
                                                   const struct cosmos_database_client *database,
                                                   const char *container_id,
                                                   struct cosmos_container_client **out_container);

/**
 * Reads the properties of the specified database and returns them as a JSON string.
 *
 * # Arguments
 * * `ctx` - Pointer to a [`CallContext`] to use for this call.
 * * `database` - Pointer to the [`DatabaseClient`].
 * * `options` - Pointer to [`ReadDatabaseOptions`] for read configuration, may be null.
 * * `out_json` - Output parameter that will receive a pointer to the JSON string.
 */
cosmos_error_code cosmos_database_read(struct cosmos_call_context *ctx,
                                       const struct cosmos_database_client *database,
                                       const struct cosmos_read_database_options *options,
                                       const char **out_json);

/**
 * Deletes the specified database.
 *
 * # Arguments
 * * `ctx` - Pointer to a [`CallContext`] to use for this call.
 * * `database` - Pointer to the [`DatabaseClient`].
 * * `options` - Pointer to [`DeleteDatabaseOptions`] for delete configuration, may be null.
 */
cosmos_error_code cosmos_database_delete(struct cosmos_call_context *ctx,
                                         const struct cosmos_database_client *database,
                                         const struct cosmos_delete_database_options *options);

/**
 * Creates a new container within the specified database.
 *
 * # Arguments
 * * `ctx` - Pointer to a [`CallContext`] to use for this call.
 * * `database` - Pointer to the [`DatabaseClient`].
 * * `container_id` - The container ID as a nul-terminated C string.
 * * `partition_key_path` - The partition key path as a nul-terminated C string.
 * * `options` - Pointer to [`CreateContainerOptions`] for create container configuration, may be null.
 * * `out_container` - Output parameter that will receive a pointer to the newly created [`ContainerClient`].
 */
cosmos_error_code cosmos_database_create_container(struct cosmos_call_context *ctx,
                                                   const struct cosmos_database_client *database,
                                                   const char *container_id,
                                                   const char *partition_key_path,
                                                   const struct cosmos_create_container_options *options,
                                                   struct cosmos_container_client **out_container);

/**
 * Queries the containers within the specified database and returns the results as a JSON string.
 *
 * # Arguments
 * * `ctx` - Pointer to a [`CallContext`] to use for this call.
 * * `database` - Pointer to the [`DatabaseClient`].
 * * `query` - The query string as a nul-terminated C string.
 * * `options` - Pointer to [`QueryOptions`] for query configuration, may be null.
 * * `out_json` - Output parameter that will receive a pointer to the JSON string.
 */
cosmos_error_code cosmos_database_query_containers(struct cosmos_call_context *ctx,
                                                   const struct cosmos_database_client *database,
                                                   const char *query,
                                                   const struct cosmos_query_options *options,
                                                   const char **out_json);

/**
 * Creates a new [`RuntimeContext`] for Cosmos DB Client API calls.
 *
 * This must be called before any other Cosmos DB Client API functions are used,
 * and the returned pointer must be passed within a `CallContext` structure to those functions.
 *
 * When the `RuntimeContext` is no longer needed, it should be freed using the
 * [`cosmos_runtime_context_free`] function. However, if the program is terminating,
 * it is not strictly necessary to free it.
 *
 * If this function fails, it will return a null pointer, and the `out_error` parameter
 * (if not null) will be set to contain the error details.
 *
 * The error will contain a dynamically-allocated [`CosmosError::detail`] string that must be
 * freed by the caller using the [`cosmos_string_free`](crate::string::cosmos_string_free) function.
 *
 * # Arguments
 *
 * * `options` - Pointer to [`RuntimeOptions`] for runtime configuration, may be null.
 * * `out_error` - Output parameter that will receive error details if the function fails.
 */
struct cosmos_runtime_context *cosmos_runtime_context_create(const struct cosmos_runtime_options *options,
                                                             struct cosmos_error *out_error);

/**
 * Destroys a [`RuntimeContext`] created by [`cosmos_runtime_context_create`].
 * This frees the memory associated with the `RuntimeContext`.
 */
void cosmos_runtime_context_free(struct cosmos_runtime_context *ctx);

#ifdef __cplusplus
}  // extern "C"
#endif  // __cplusplus
