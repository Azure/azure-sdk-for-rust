// Copyright (c) Microsoft Corporation. All rights reserved.
//
// Licensed under the MIT License. See License.txt in the project root for license information.
// Code generated by Microsoft (R) Rust Code Generator. DO NOT EDIT.

use super::{
    ListOfSignedIdentifier, QueueClientGetMetadataResult, QueueClientSetAccessPolicyResult,
    QueueServiceStats,
};
use azure_core::{
    http::{
        headers::{HeaderName, Headers},
        NoFormat, Response, XmlFormat,
    },
    time::{parse_rfc7231, OffsetDateTime},
    Result,
};
use std::collections::HashMap;

const DATE: HeaderName = HeaderName::from_static("date");
const META: &str = "x-ms-meta-";

/// Provides access to typed response headers for `QueueClient::get_access_policy()`
///
/// # Examples
///
/// ```no_run
/// use azure_core::{Result, http::{Response, XmlFormat}};
/// use azure_storage_queue::models::{ListOfSignedIdentifier, ListOfSignedIdentifierHeaders};
/// async fn example() -> Result<()> {
///     let response: Response<ListOfSignedIdentifier, XmlFormat> = unimplemented!();
///     // Access response headers
///     if let Some(date) = response.date()? {
///         println!("Date: {:?}", date);
///     }
///     Ok(())
/// }
/// ```
pub trait ListOfSignedIdentifierHeaders: private::Sealed {
    fn date(&self) -> Result<Option<OffsetDateTime>>;
}

impl ListOfSignedIdentifierHeaders for Response<ListOfSignedIdentifier, XmlFormat> {
    /// UTC date/time value generated by the service that indicates the time at which the response was initiated
    fn date(&self) -> Result<Option<OffsetDateTime>> {
        Headers::get_optional_with(self.headers(), &DATE, |h| parse_rfc7231(h.as_str()))
    }
}

/// Provides access to typed response headers for `QueueClient::get_metadata()`
///
/// # Examples
///
/// ```no_run
/// use azure_core::{Result, http::{Response, NoFormat}};
/// use azure_storage_queue::models::{QueueClientGetMetadataResult, QueueClientGetMetadataResultHeaders};
/// async fn example() -> Result<()> {
///     let response: Response<QueueClientGetMetadataResult, NoFormat> = unimplemented!();
///     // Access response headers
///     let metadata = response.metadata()?;
///     println!("x-ms-meta: {:?}", metadata);
///     Ok(())
/// }
/// ```
pub trait QueueClientGetMetadataResultHeaders: private::Sealed {
    fn metadata(&self) -> Result<HashMap<String, String>>;
}

impl QueueClientGetMetadataResultHeaders for Response<QueueClientGetMetadataResult, NoFormat> {
    /// The metadata headers.
    fn metadata(&self) -> Result<HashMap<String, String>> {
        let mut values = HashMap::new();
        for h in self.headers().iter() {
            let name = h.0.as_str();
            if name.len() > META.len() && name.starts_with(META) {
                values.insert(name[META.len()..].to_owned(), h.1.as_str().to_owned());
            }
        }
        Ok(values)
    }
}

/// Provides access to typed response headers for `QueueClient::set_access_policy()`
///
/// # Examples
///
/// ```no_run
/// use azure_core::{Result, http::{Response, NoFormat}};
/// use azure_storage_queue::models::{QueueClientSetAccessPolicyResult, QueueClientSetAccessPolicyResultHeaders};
/// async fn example() -> Result<()> {
///     let response: Response<QueueClientSetAccessPolicyResult, NoFormat> = unimplemented!();
///     // Access response headers
///     if let Some(date) = response.date()? {
///         println!("Date: {:?}", date);
///     }
///     Ok(())
/// }
/// ```
pub trait QueueClientSetAccessPolicyResultHeaders: private::Sealed {
    fn date(&self) -> Result<Option<OffsetDateTime>>;
}

impl QueueClientSetAccessPolicyResultHeaders
    for Response<QueueClientSetAccessPolicyResult, NoFormat>
{
    /// UTC date/time value generated by the service that indicates the time at which the response was initiated
    fn date(&self) -> Result<Option<OffsetDateTime>> {
        Headers::get_optional_with(self.headers(), &DATE, |h| parse_rfc7231(h.as_str()))
    }
}

/// Provides access to typed response headers for `QueueServiceClient::get_statistics()`
///
/// # Examples
///
/// ```no_run
/// use azure_core::{Result, http::{Response, XmlFormat}};
/// use azure_storage_queue::models::{QueueServiceStats, QueueServiceStatsHeaders};
/// async fn example() -> Result<()> {
///     let response: Response<QueueServiceStats, XmlFormat> = unimplemented!();
///     // Access response headers
///     if let Some(date) = response.date()? {
///         println!("Date: {:?}", date);
///     }
///     Ok(())
/// }
/// ```
pub trait QueueServiceStatsHeaders: private::Sealed {
    fn date(&self) -> Result<Option<OffsetDateTime>>;
}

impl QueueServiceStatsHeaders for Response<QueueServiceStats, XmlFormat> {
    /// UTC date/time value generated by the service that indicates the time at which the response was initiated
    fn date(&self) -> Result<Option<OffsetDateTime>> {
        Headers::get_optional_with(self.headers(), &DATE, |h| parse_rfc7231(h.as_str()))
    }
}

mod private {
    use super::{
        ListOfSignedIdentifier, QueueClientGetMetadataResult, QueueClientSetAccessPolicyResult,
        QueueServiceStats,
    };
    use azure_core::http::{NoFormat, Response, XmlFormat};

    pub trait Sealed {}

    impl Sealed for Response<ListOfSignedIdentifier, XmlFormat> {}
    impl Sealed for Response<QueueClientGetMetadataResult, NoFormat> {}
    impl Sealed for Response<QueueClientSetAccessPolicyResult, NoFormat> {}
    impl Sealed for Response<QueueServiceStats, XmlFormat> {}
}
