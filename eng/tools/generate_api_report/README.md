# Azure Rust API Exporter

## Generate API Report

This tool generates a JSON report of the API documentation for a specified Rust package.
It uses the following command `cargo +nightly rustdoc -Z unstable-options --output-format json --package {package_name} --all-features` to generate the documentation in JSON format, processes the JSON to remove unnecessary attributes, and outputs a cleaned-up version of the JSON.

## Version Compatibility

When updating the `rustdoc-types` in Cargo.toml, ensure that the `rust-api-parser` in the tools repository is also updated along with this project.

1. Check the `FORMAT_VERSION` value in the new version.
2. Verify that it is compatible with your rustdoc JSON output version (generated by `cargo +nightly rustdoc ...`).
3. If they do not match, you may need to use a different version of `rustdoc-types`.

Current `FORMAT_VERSION`: 37 (as of rustdoc-types 0.33.0)

## Usage

To run the tool, navigate to the root of the `azure-sdk-for-rust` repository and use the following command:

```sh
    cargo run --manifest-path eng/tools/generate_api_report/Cargo.toml -- --package package_name
```

Generates `package_name.rust.json` in the `sdk/service_folder/package_name/review` directory.

For example, to generate the report for a package named `azure_core`, run:

```bash
    cargo run --manifest-path eng/tools/generate_api_report/Cargo.toml -- --package azure_core
```

## Functionality

1. **Generate JSON Documentation**: The tool runs `cargo +nightly rustdoc ...` to generate the JSON documentation.
2. **Process JSON**: The tool reads the JSON file, removes the `span` attribute from each item, and retains important attributes like `crate_version`, `inner`, and `format_version`.
3. **Output Cleaned JSON**: The tool writes the cleaned-up JSON to a new file `package_name/review/package_name.rust.json`.

## Contributing

Contributions are welcome! Please open an issue or submit a pull request with your changes.

## Troubleshooting

If you encounter any issues, please check the [Version Compatibility](#version-compatibility) section.

## License

This project is licensed under the MIT License.
