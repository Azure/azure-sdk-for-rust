parameters:
  - name: InstallLanguageSteps
    type: object
    default: []
  - name: ServiceDirectory
    type: string
    default: ""
  - name: PackageVersions
    type: string
    default: ".*"
  - name: Tests
    type: string
    default: ".*"
  - name: Arguments
    type: string
    default: ".*"
  - name: Iterations
    type: number
    default: "1"
  - name: AdditionalArguments
    type: string
    default: ""
  - name: Profile
    type: boolean
    default: false
  - name: EnvVars
    type: object
    default: []

extends:
  template: /eng/common/pipelines/templates/jobs/perf.yml
  parameters:
    Variables:
      - template: /eng/pipelines/templates/variables/globals.yml
    Language: Rust
    LanguageVersion: "N/A"
    InstallLanguageSteps:
      - template: /eng/common/testproxy/test-proxy-tool.yml
        parameters:
          runProxy: true
          rootFolder: "$(Build.SourcesDirectory)/sdk/${{parameters.ServiceDirectory}}"
          templateFolder: "$(Build.SourcesDirectory)/sdk/${{parameters.ServiceDirectory}}"
      - script: ls -R /mnt/vss/_work/1/s/sdk/core/
        displayName: list files
      - script: cat /mnt/vss/_work/1/s/sdk/core/perf-tests.yml
        displayName: list files
    ServiceDirectory: ${{ parameters.ServiceDirectory }}
    PackageVersions: ${{ parameters.PackageVersions }}
    Tests: ${{ parameters.Tests }}
    Arguments: ${{ parameters.Arguments }}
    Iterations: ${{ parameters.Iterations }}
    AdditionalArguments: ${{ parameters.AdditionalArguments }}
    Profile: ${{ parameters.Profile }}
    EnvVars: ${{ parameters.EnvVars}}
