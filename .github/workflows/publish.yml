name: Publish Crate

on:
  workflow_dispatch:
    inputs:
      directory:
        description: The directory to run from
        required: true
        default: .
        type: string
      package:
        description: The package to publish
        required: true
        type: string
    secrets:
      CARGO_REGISTRY_TOKEN:
        description: The crates.io registry token
        required: true

# Do NOT add your CARGO_REGISTRY_TOKEN to Azure/azure-sdk-for-rust repository. Only add it to your repository.
# The publish actions are intended for running in your own fork where only you have access to run the actions.
env:
  CARGO_REGISTRY_TOKEN: ${{ secrets.CARGO_REGISTRY_TOKEN }}

jobs:
  publish:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: publish
        run: |
          cd ${{ inputs.directory }}
          cargo publish -p ${{ inputs.package }}
